version: 0.0.{build}
image: Visual Studio 2017

environment:
  DOCKER_USER:
    secure: zYh2E1Ev8iysKYqh1JQnjA==
  DOCKER_PASS:
    secure: fzKLKWlgyXg+GYPF9tvvrA==

install:
  docker version
build_script:
  - docker build -t solthoth/iis-chocolatey:latest .
  - docker tag solthoth/iis-chocolatey:latest solthoth/iis-chocolatey:0.0.{build}
before_deploy:
  ps: docker login -u "$env:DOCKER_USER" -p "$env:DOCKER_PASS"
deploy_script:
  - docker push solthoth/iis-chocolatey:latest
  - docker push solthoth/iis-chocolatey:0.0.{build}
after_deploy:
  docker logout